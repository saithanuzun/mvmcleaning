@inject Microsoft.Extensions.Configuration.IConfiguration Configuration

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- Use CDN for common libraries; custom CSS can be served from CDN via config fallback to local -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          crossorigin="anonymous">

    @await RenderSectionAsync("Scripts", required: false)

    

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;800&display=swap" rel="stylesheet">

    @{
        // Smart title formatting: if a page sets a very short title (e.g. "Contact") we expand it
        // so titles fall into the 20-60 character recommendation and include service keywords.
        var rawTitle = (ViewData["Title"] as string) ?? string.Empty;
        var brand = "MvM Cleaning";
        string title;

        if (string.IsNullOrWhiteSpace(rawTitle))
        {
            title = $"{brand} | BOOK ONLINE | Carpet & Sofa Cleaning | 5 Star Service";
        }
        else
        {
            var t = rawTitle.Trim();
            if (t.Length < 20)
            {
                // Expand short titles with service and location keywords
                title = $"{t} — Professional Carpet & Sofa Cleaning in Leicestershire | {brand}";
            }
            else if (!t.Contains(brand, StringComparison.OrdinalIgnoreCase))
            {
                // Append brand for longer human-friendly titles
                title = $"{t} | {brand}";
            }
            else
            {
                title = t;
            }
        }

        var rawMeta = (ViewData["MetaDescription"] as string) ?? string.Empty;
        var defaultMeta = "⭐️ 5/5 rated carpet & sofa cleaners in Leicester. Carpet Cleaning, free quotes & same-day service. Book online or call 07405 392635.";

        string metaDescription;
        if (string.IsNullOrWhiteSpace(rawMeta))
        {
            metaDescription = defaultMeta;
        }
        else
        {
            metaDescription = rawMeta.Trim();
            // If the provided description is short, expand with service/location CTA to reach ~150+ chars
            if (metaDescription.Length < 150)
            {
                var suffix = " Book professional carpet, sofa & upholstery cleaning in Leicester. Call 07405 392635 or book online at mvmcleaning.co.uk.";
                metaDescription = (metaDescription + " " + suffix).Trim();
            }

            // Ensure meta description isn't longer than ~220 characters — truncate cleanly
            if (metaDescription.Length > 220)
            {
                metaDescription = metaDescription.Substring(0, 217).TrimEnd() + "...";
            }
        }

        // Canonical URL: prefer an explicit configuration `Site:BaseUrl` (e.g. "https://mvmcleaning.com").
        // This avoids hard-coding http:// and ensures canonical points to the preferred host/scheme.
        var configuredBase = Configuration["Site:BaseUrl"]?.TrimEnd('/');
        string baseForCanonical;
        if (!string.IsNullOrEmpty(configuredBase))
        {
            baseForCanonical = configuredBase;
        }
        else
        {
            // Fallback: prefer HTTPS if the request was HTTPS, otherwise use the request scheme.
            var scheme = Context.Request.IsHttps ? "https" : Context.Request.Scheme;
            baseForCanonical = $"{scheme}://{Context.Request.Host}";
        }

        var canonical = (ViewData["CanonicalUrl"] as string) ?? $"{baseForCanonical}{Context.Request.Path}{Context.Request.QueryString}";
        var noindex = (ViewData["NoIndex"] as bool?) ?? false;
        var ogTitle = (ViewData["OgTitle"] as string) ?? title;
        var ogDesc = (ViewData["OgDescription"] as string) ?? metaDescription;
        var ogImage = (ViewData["OgImage"] as string) ?? "https://www.mvmcleaning.com/img/logo.png";
    }

    <!-- Primary Meta Tags -->
    <title>@title</title>
    <meta name="description" content="@metaDescription">
    <meta name="keywords"
          content="carpet cleaner, sofa cleaner, carpet cleaning leicester, sofa cleaning leicester, leicester Sofa Cleaner, sofa Cleaner near me, Sofa Cleaning, carpet cleaner near me, Leicester carpet cleaner, emergency stain removal, pet odor removal Leicester, sofa cleaning Leicester, upholstery cleaning, commercial carpet cleaning, best carpet cleaners Leicester, LE3 carpet cleaning, same day carpet cleaning, jet washing Leicester, mvm cleaning, pressure washing">
    <meta name="robots" content="@(noindex ? "noindex, nofollow" : "index, follow")">

    <!-- Favicon -->
    <link href="/img/logo.png" rel="icon" type="image/png">

    <!-- Geo Tags -->
    <meta name="geo.region" content="GB-LEE"/>
    <meta name="geo.placename" content="Leicester"/>
    <meta name="geo.position" content="52.6369;-1.1398"/>
    <meta name="ICBM" content="52.6369, -1.1398"/>

    <!-- Google tag (gtag.js) - load non-blocking and initialize after load -->
    <script>
        (function () {
            var s = document.createElement('script');
            s.src = 'https://www.googletagmanager.com/gtag/js?id=AW-17424866501';
            s.async = true;
            s.onload = function () {
                window.dataLayer = window.dataLayer || [];

                function gtag() {
                    dataLayer.push(arguments);
                }

                window.gtag = gtag;
                gtag('js', new Date());
                gtag('config', 'AW-17424866501');
            };
            document.head.appendChild(s);
        })();
    </script>

    <!-- Canonical -->
    <link rel="canonical" href="@canonical"/>

    <!-- Schema.org Markup -->
    <script type="application/ld+json">
        {
            "@@context": "https://schema.org",
            "@@type": "LocalBusiness",
            "name": "MvM Cleaning",
            "image": "https://www.mvmcleaning.com/img/logo.png",
            "url": "https://www.mvmcleaning.com",
            "telephone": "+44-7405-392635",
            "priceRange": "££",
            "description": "@metaDescription",
        "address": {
            "@@type": "PostalAddress",
            "streetAddress": "72 Darien Way",
            "addressLocality": "Leicester",
            "addressRegion": "Leicestershire",
            "postalCode": "LE3 3TT",
            "addressCountry": "UK"
        },
        "areaServed": [
            { "@@type": "City", "name": "Leicester" },
            { "@@type": "City", "name": "Coventry" },
            { "@@type": "City", "name": "Loughborough" },
            { "@@type": "City", "name": "Coalville" },
            { "@@type": "City", "name": "Hinckley" },
            { "@@type": "City", "name": "Market Harborough" },
            { "@@type": "City", "name": "Melton Mowbray" },
            { "@@type": "City", "name": "Ashby-de-la-Zouch" },
            { "@@type": "City", "name": "Nuneaton" },
            { "@@type": "City", "name": "Bedworth" },
            { "@@type": "City", "name": "Wigston" },
            { "@@type": "City", "name": "Oadby" },
            { "@@type": "City", "name": "Syston" },
            { "@@type": "City", "name": "Blaby" },
            { "@@type": "City", "name": "Shepshed" },
            { "@@type": "City", "name": "Earl Shilton" },
            { "@@type": "City", "name": "Thurmaston" },
        
        
            { "@@type": "Place", "name": "Leicester (LE1)" },
            { "@@type": "Place", "name": "Leicester (LE2)" },
            { "@@type": "Place", "name": "Leicester (LE3)" }, 
            { "@@type": "Place", "name": "Leicester (LE4)" },
            { "@@type": "Place", "name": "Leicester (LE5)" },
            { "@@type": "Place", "name": "Leicester (LE6)" },
            { "@@type": "Place", "name": "Leicester (LE7)" },
            { "@@type": "Place", "name": "Leicester (LE8)" },
            { "@@type": "Place", "name": "Leicester (LE9)" },
            { "@@type": "Place", "name": "Leicester (LE10)" }, 
            { "@@type": "Place", "name": "Loughborough (LE11)" },
            { "@@type": "Place", "name": "Loughborough (LE12)" }, 
            { "@@type": "Place", "name": "Melton Mowbray (LE13)" },
            { "@@type": "Place", "name": "Market Harborough (LE16)" },
            { "@@type": "Place", "name": "Wigston (LE18)" },
            { "@@type": "Place", "name": "Enderby (LE19)" },
            { "@@type": "Place", "name": "Ashby-de-la-Zouch (LE65)" },
            { "@@type": "Place", "name": "Coalville (LE67)" },
        
            { "@@type": "Place", "name": "Coventry (CV1)" },
            { "@@type": "Place", "name": "Coventry (CV2)" },
            { "@@type": "Place", "name": "Coventry (CV3)" },
            { "@@type": "Place", "name": "Coventry (CV4)" },
            { "@@type": "Place", "name": "Coventry (CV5)" },
            { "@@type": "Place", "name": "Coventry (CV6)" },
            { "@@type": "Place", "name": "Coventry (CV7)" }, 
            { "@@type": "Place", "name": "Nuneaton (CV10)" },
            { "@@type": "Place", "name": "Nuneaton (CV11)" },
            { "@@type": "Place", "name": "Bedworth (CV12)" },
        
            { "@@type": "AdministrativeArea", "name": "Leicestershire" },
            { "@@type": "AdministrativeArea", "name": "Warwickshire" }, 
            { "@@type": "AdministrativeArea", "name": "Derbyshire" } 
        ],
        "openingHoursSpecification": {
            "@@type": "OpeningHoursSpecification",
            "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday","Sunday"],
            "opens": "08:00",
            "closes": "20:00"
        },
        "contactPoint": {
            "@@type": "ContactPoint",
            "telephone": "+44-7405-392635",
            "contactType": "customer service",
            "areaServed": "Leicester"
        },
        "sameAs": [
            "https://www.instagram.com/mvm_cleaning/",
            "https://www.facebook.com/profile.php?id=61565094595129"
        ],
        "offers": [
            {
                "@@type": "Offer",
                "priceCurrency": "GBP",
                "price": "40",
                "availability": "https://schema.org/InStock",
                "itemOffered": {
                    "@@type": "Service",
                    "name": "Carpet Cleaning",
                    "description": "Professional deep cleaning for all carpet types"
                }
            },
            {
                "@@type": "Offer",
                "priceCurrency": "GBP",
                "price": "120",
                "availability": "https://schema.org/InStock",
                "itemOffered": {
                    "@@type": "Service",
                    "name": "Jet Wash",
                    "description": "High-pressure exterior cleaning service"
                }
            }
        ],
        "aggregateRating": {
            "@@type": "AggregateRating",
            "ratingValue": "4.9",
            "reviewCount": "59"
          }
    }
    </script>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="@canonical">
    <meta property="og:title" content="@ogTitle">
    <meta property="og:description" content="@ogDesc">
    <meta property="og:image" content="@ogImage">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_GB">
    <meta property="og:site_name" content="MvM Cleaning Services">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="@canonical">
    <meta property="twitter:title" content="@ogTitle">
    <meta property="twitter:description" content="@ogDesc">
    <meta property="twitter:image" content="@ogImage">

    <!-- CSS (load synchronously to restore original appearance) -->
    <link rel="stylesheet" href="~/css/style.css" asp-append-version="true">

    

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet (owl carousel) -->
    <!-- Libraries Stylesheet (owl carousel) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" rel="stylesheet">
   


    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YZNYK59SCG"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-YZNYK59SCG');
    </script>

</head>


<body>

<header class=" fixed-top">
    @await Html.PartialAsync("_Header")
    
</header>
<div style="padding-top: 150px;">
    <main>
        @RenderBody()
    </main>
</div>

<footer>
    @await Html.PartialAsync("_Footer")
</footer>


</body>
</html>